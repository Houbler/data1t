|QUERY PLAN                                                                                                                                                                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|Gather Motion 2:1  (slice1; segments: 2)  (cost=0.00..437.01 rows=1 width=16)                                                                                                                                                                                        |
|  Merge Key: products.product_name                                                                                                                                                                                                                                   |
|  ->  GroupAggregate  (cost=0.00..437.01 rows=1 width=16)                                                                                                                                                                                                            |
|        Group Key: products.product_name                                                                                                                                                                                                                             |
|        ->  Sort  (cost=0.00..437.01 rows=1 width=12)                                                                                                                                                                                                                |
|              Sort Key: products.product_name                                                                                                                                                                                                                        |
|              ->  Redistribute Motion 2:2  (slice2; segments: 2)  (cost=0.00..437.01 rows=1 width=12)                                                                                                                                                                |
|                    Hash Key: products.product_name                                                                                                                                                                                                                  |
|                    ->  Hash Join  (cost=0.00..437.01 rows=1 width=12)                                                                                                                                                                                               |
|                          Hash Cond: (sales_facts.product_id = products.product_id)                                                                                                                                                                                  |
|                          Join Filter: ((products.product_id = 1) OR ((products.product_id = 2) AND (sales_facts.sale_date >= '2024-06-15 00:00:00'::timestamp without time zone) AND (sales_facts.sale_date <= '2024-07-15 00:00:00'::timestamp without time zone)))|
|                          ->  Redistribute Motion 2:2  (slice3; segments: 2)  (cost=0.00..431.00 rows=11 width=16)                                                                                                                                                   |
|                                Hash Key: sales_facts.product_id                                                                                                                                                                                                     |
|                                ->  Dynamic Seq Scan on sales_facts  (cost=0.00..431.00 rows=11 width=16)                                                                                                                                                            |
|                                      Number of partitions to scan: 12 (out of 12)                                                                                                                                                                                   |
|                                      Filter: (product_id = ANY ('{1,2}'::integer[]))                                                                                                                                                                                |
|                          ->  Hash  (cost=6.00..6.00 rows=1 width=12)                                                                                                                                                                                                |
|                                ->  Index Scan using products_pkey on products  (cost=0.00..6.00 rows=1 width=12)                                                                                                                                                    |
|                                      Index Cond: (product_id = ANY ('{1,2}'::integer[]))                                                                                                                                                                            |
|                                      Filter: ((product_id = 1) OR (product_id = 2))                                                                                                                                                                                 |
|Optimizer: GPORCA                                                                                                                                                                                                                                                    |
